<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="JavaScript基础之继承实现" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="继承可以使得子类具有父类的方法和属性，同时也可以重新定义父类的某些属性，并重写或者覆盖某些属性和方法。使得子类具有与父类不同的属性和方法。" /><meta property="og:description" content="继承可以使得子类具有父类的方法和属性，同时也可以重新定义父类的某些属性，并重写或者覆盖某些属性和方法。使得子类具有与父类不同的属性和方法。" /><link rel="canonical" href="https://yuxingxin.github.io/posts/javascript-inherit/" /><meta property="og:url" content="https://yuxingxin.github.io/posts/javascript-inherit/" /><meta property="og:site_name" content="宇行信" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-03-06T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JavaScript基础之继承实现" /><meta name="twitter:site" content="@yuxingxin" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2018-03-06T00:00:00+00:00","datePublished":"2018-03-06T00:00:00+00:00","description":"继承可以使得子类具有父类的方法和属性，同时也可以重新定义父类的某些属性，并重写或者覆盖某些属性和方法。使得子类具有与父类不同的属性和方法。","headline":"JavaScript基础之继承实现","mainEntityOfPage":{"@type":"WebPage","@id":"https://yuxingxin.github.io/posts/javascript-inherit/"},"url":"https://yuxingxin.github.io/posts/javascript-inherit/"}</script><title>JavaScript基础之继承实现 | 宇行信</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="宇行信"><meta name="application-name" content="宇行信"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://p26-passport.byteacctimg.com/img/user-avatar/48ea01ce7b18b0e8c3332207950bc317~300x300.image" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">宇行信</a></div><div class="site-subtitle font-italic">Just Keep Sharing</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/yuxingxin" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://weibo.com/lx8909" aria-label="weibo" target="_blank" rel="noopener"> <i class="fab fa-weibo"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['imyuxingxin','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>JavaScript基础之继承实现</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>JavaScript基础之继承实现</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1520294400" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2018-03-06 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href="https://weibo.com/lx8909">yuxingxin</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2649 字"> <em>14 分钟</em>阅读</span></div></div></div><div class="post-content"><p>继承可以使得子类具有父类的方法和属性，同时也可以重新定义父类的某些属性，并重写或者覆盖某些属性和方法。使得子类具有与父类不同的属性和方法。</p><p>接下来我们就来一起看看实现继承的几种方式</p><h2 id="1-原型链继承"><span class="mr-2">1. 原型链继承</span><a href="#1-原型链继承" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>原型链继承是比较常见的继承方式之一，其基本思想是利用原型让一个引用类型继承另一个引用类型的属性和方法。其中涉及的构造函数、原型和实例，三者之间存在着一定的关系，即每一个构造函数都有一个原型对象（构造函数的<code class="language-plaintext highlighter-rouge">prototype</code>属性），原型对象又包含一个指向构造函数的指针（原型对象的<code class="language-plaintext highlighter-rouge">constructor</code>属性），而实例则包含一个原型对象的指针（实例对象的<code class="language-plaintext highlighter-rouge">__proto__</code>属性）。</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">Parent</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">这是父类</span><span class="dl">"</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span>

<span class="nx">Parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getContent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Child</span><span class="p">()</span> <span class="p">{</span>
    
<span class="p">}</span>

<span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Parent</span><span class="p">();</span>

<span class="kd">var</span> <span class="nx">child1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">();</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4]</span>

<span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">();</span>
<span class="nx">child2</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>  
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getContent</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4,5]</span>
</pre></table></code></div></div><p>虽然上面子类可以复用父类的属性和方法，但是这里面存在着一个问题：两个实例共用一个原型对象，它们的内存空间是共享的，当一个发生变化的时候，另外一个也随之进行了变化。下面我们看看其他继承方式如何解决这个问题</p><h2 id="2-构造函数继承"><span class="mr-2">2. 构造函数继承</span><a href="#2-构造函数继承" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">Parent</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">getContent1</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">content</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">Parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getContent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Child</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Parent</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">child1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">(</span><span class="dl">"</span><span class="s2">这是子类1</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent</span><span class="p">())</span>  <span class="c1">// 报错</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent1</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4]</span>

<span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">(</span><span class="dl">"</span><span class="s2">这是子类2</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">child2</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>  
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getContent1</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,5]</span>

</pre></table></code></div></div><p>从上面实例我们也可以总结该方法的优缺点：</p><p>优点：</p><ol><li>解决了第一种继承方式的缺点，即避免了引用类型属性被所有实例共享<li>可以直接在Child中向Parent传参</ol><p>缺点：</p><ol><li>只能继承父类的实例属性和方法，不能继承其原型属性或者方法。</ol><p>那么上面两者都有不足的地方， 我们可以组合上面两种实现方式</p><h2 id="3-组合继承"><span class="mr-2">3. 组合继承</span><a href="#3-组合继承" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">Parent</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">getContent1</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">content</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">Parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getContent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Child</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Parent</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span>  <span class="c1">// 创建子类实例时执行一次</span>
<span class="p">}</span>

<span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Parent</span><span class="p">();</span>  <span class="c1">// 指定子类原型会执行一次</span>
<span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">Child</span><span class="p">;</span> <span class="c1">// 校正构造函数</span>

<span class="kd">var</span> <span class="nx">child1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">(</span><span class="dl">"</span><span class="s2">这是子类1</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4]</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent1</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4]</span>

<span class="kd">var</span> <span class="nx">child2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">(</span><span class="dl">"</span><span class="s2">这是子类2</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">child2</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>  
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getContent1</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,5]</span>
</pre></table></code></div></div><p>从上面实例可以看出，组合继承解决了前面提到的两个问题，既具有原型链继承能够复用函数的特性，又有借用构造函数方式能够保证每个子类实例能够拥有自己的属性以及向父类传参的特性，但组合继承也并不是完美实现继承的方式，因为这种方式在创建子类时会调用两次父类的构造函数，这是我们不愿意看到的，因为每一次的调用都会是一次性能开销，接着看我们如何解决这个问题。</p><h2 id="4-原型式继承"><span class="mr-2">4. 原型式继承</span><a href="#4-原型式继承" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>ECMAScript5通过新增Object.create()方法规范化了原型式继承，这个方法接收两个参数：一个用作新对象原型的对象和为新对象定义属性的对象（可选参数）。</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">这是父类</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">content</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    
    <span class="na">getContent</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="na">getName</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">child1</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">这是子类child1</span><span class="dl">"</span>
<span class="nx">child1</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>  <span class="c1">// 这是子类child1</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="nx">child1</span><span class="p">.</span><span class="nx">getName</span><span class="p">())</span> <span class="c1">// true</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4]</span>

<span class="kd">let</span> <span class="nx">child2</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
<span class="nx">child2</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> 
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child2</span><span class="p">.</span><span class="nx">getContent</span><span class="p">())</span>  <span class="c1">// Array [1,2,3,4,5] </span>
</pre></table></code></div></div><p>通过以上代码也可以知道，这种继承方式缺点也很明显，多个实例引用类型属性指向相同的内存，接下来看如何优化它。</p><h2 id="5-寄生式继承"><span class="mr-2">5. 寄生式继承</span><a href="#5-寄生式继承" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>寄生式继承和上面的原型式继承密切相关，即创建一个仅用于封装继承函数过程的函数，在该函数内部以某种方式来增强对象，最后返回该对象。</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">parent</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">这是父类</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">content</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    
    <span class="na">getContent</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">createChild</span><span class="p">(){</span>
    <span class="kd">let</span> <span class="nx">child</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
    <span class="nx">child</span><span class="p">.</span><span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">child</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">createChild</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">getName</span><span class="p">());</span>   
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">getContent</span><span class="p">());</span>
</pre></table></code></div></div><p>该方式通过createChild函数在继承过程中又增加了一个getName方法，这样的继承方式就是寄生式继承。而上面第三点提到的性能开销问题，可以通过下面方式来解决:寄生式+组合继承</p><h2 id="6-寄生组合式继承"><span class="mr-2">6. 寄生组合式继承</span><a href="#6-寄生组合式继承" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>所谓寄生组合式继承，即通过构造函数来继承属性，通过原型链继承方法，背后的基本思路是：不必为了指定子类的原型而调用父类的构造函数，我们所需要的无非就是父类原型的一个副本而已。</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">Parent</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">这是父类</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">content</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span>

<span class="nx">Parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Child</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Parent</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">create</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span><span class="nx">child</span><span class="p">)</span> <span class="p">{</span> 
    <span class="c1">//改变子类的原型，同时纠正构造函数</span>
    <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
    <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">create</span><span class="p">(</span><span class="nx">Parent</span><span class="p">,</span> <span class="nx">Child</span><span class="p">);</span>
<span class="nx">Child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getContent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">child1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">();</span> 

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getName</span><span class="p">())</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">child1</span><span class="p">.</span><span class="nx">getContent</span><span class="p">());</span>
</pre></table></code></div></div><p>通过以上代码可以看出寄生组合继承的高效率在于它只调用了一次父类构造函数，同时还能够保持原型链不变，能够正常使用 instanceof 和 isPrototypeOf() ，寄生组合继承被普遍认为是引用类型最理想的继承方式。</p><h2 id="es6-关键字extends"><span class="mr-2">ES6 关键字extends</span><a href="#es6-关键字extends" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>最后我们一起来看下ES6的语法糖，深入底层逻辑研究extends是如何实现的，这里借助<a href="https://www.babeljs.cn/repl/">babel转换</a>，代码如下：</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nx">Parent</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span>
  <span class="p">}</span>
  <span class="c1">// 原型方法</span>
  <span class="c1">// 即 Person.prototype.getName = function() { }</span>
  <span class="c1">// 下面可以简写为 getName() {...}</span>
  <span class="nx">getName</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Parent:</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Child</span> <span class="kd">extends</span> <span class="nx">Person</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 子类中存在构造函数，则需要在使用“this”之前首先调用 super()。</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">(</span><span class="dl">'</span><span class="s1">yuxingxin</span><span class="dl">'</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">getName</span><span class="p">()</span> <span class="c1">// 成功访问到父类的方法</span>
</pre></table></code></div></div><p>我们借助Babel转译成ES5，来看下代码是如何实现的？</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
</pre><td class="rouge-code"><pre><span class="dl">"</span><span class="s2">use strict</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">_typeof</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="dl">"</span><span class="s2">@babel/helpers - typeof</span><span class="dl">"</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">(</span><span class="nx">_typeof</span> <span class="o">=</span>
      <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nb">Symbol</span> <span class="o">&amp;&amp;</span> <span class="dl">"</span><span class="s2">symbol</span><span class="dl">"</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nb">Symbol</span><span class="p">.</span><span class="nx">iterator</span>
        <span class="p">?</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span>
              <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span> <span class="o">==</span> <span class="k">typeof</span> <span class="nb">Symbol</span> <span class="o">&amp;&amp;</span>
              <span class="nx">obj</span><span class="p">.</span><span class="kd">constructor</span> <span class="o">===</span> <span class="nb">Symbol</span> <span class="o">&amp;&amp;</span>
              <span class="nx">obj</span> <span class="o">!==</span> <span class="nb">Symbol</span><span class="p">.</span><span class="nx">prototype</span>
              <span class="p">?</span> <span class="dl">"</span><span class="s2">symbol</span><span class="dl">"</span>
              <span class="p">:</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">;</span>
          <span class="p">}),</span>
    <span class="nx">_typeof</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_inherits</span><span class="p">(</span><span class="nx">subClass</span><span class="p">,</span> <span class="nx">superClass</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">superClass</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">superClass</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="dl">"</span><span class="s2">Super expression must either be null or a function</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="c1">// 注意看这里</span>
  <span class="nx">subClass</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">superClass</span> <span class="o">&amp;&amp;</span> <span class="nx">superClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">constructor</span><span class="p">:</span> <span class="p">{</span> <span class="na">value</span><span class="p">:</span> <span class="nx">subClass</span><span class="p">,</span> <span class="na">writable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="na">configurable</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
  <span class="p">});</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">subClass</span><span class="p">,</span> <span class="dl">"</span><span class="s2">prototype</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">writable</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">superClass</span><span class="p">)</span> <span class="nx">_setPrototypeOf</span><span class="p">(</span><span class="nx">subClass</span><span class="p">,</span> <span class="nx">superClass</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_setPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">_setPrototypeOf</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">setPrototypeOf</span>
    <span class="p">?</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">setPrototypeOf</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>
    <span class="p">:</span> <span class="kd">function</span> <span class="nx">_setPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">o</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">o</span><span class="p">;</span>
      <span class="p">};</span>
  <span class="k">return</span> <span class="nx">_setPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_createSuper</span><span class="p">(</span><span class="nx">Derived</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">hasNativeReflectConstruct</span> <span class="o">=</span> <span class="nx">_isNativeReflectConstruct</span><span class="p">();</span>
  <span class="k">return</span> <span class="kd">function</span> <span class="nx">_createSuperInternal</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">Super</span> <span class="o">=</span> <span class="nx">_getPrototypeOf</span><span class="p">(</span><span class="nx">Derived</span><span class="p">),</span>
      <span class="nx">result</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">hasNativeReflectConstruct</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">NewTarget</span> <span class="o">=</span> <span class="nx">_getPrototypeOf</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="kd">constructor</span><span class="p">;</span>
      <span class="nx">result</span> <span class="o">=</span> <span class="nb">Reflect</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span><span class="nx">Super</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">,</span> <span class="nx">NewTarget</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">result</span> <span class="o">=</span> <span class="nx">Super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">_possibleConstructorReturn</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_possibleConstructorReturn</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="nx">call</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">call</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">_typeof</span><span class="p">(</span><span class="nx">call</span><span class="p">)</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">object</span><span class="dl">"</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">call</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">call</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">call</span> <span class="o">!==</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">Derived constructors may only return object or undefined</span><span class="dl">"</span>
    <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">_assertThisInitialized</span><span class="p">(</span><span class="nb">self</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_assertThisInitialized</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">self</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">ReferenceError</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">this hasn't been initialised - super() hasn't been called</span><span class="dl">"</span>
    <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_isNativeReflectConstruct</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">Reflect</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">undefined</span><span class="dl">"</span> <span class="o">||</span> <span class="o">!</span><span class="nb">Reflect</span><span class="p">.</span><span class="nx">construct</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">Reflect</span><span class="p">.</span><span class="nx">construct</span><span class="p">.</span><span class="nx">sham</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">Proxy</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">function</span><span class="dl">"</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nb">Boolean</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">valueOf</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
      <span class="nb">Reflect</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">,</span> <span class="p">[],</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{})</span>
    <span class="p">);</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_getPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">_getPrototypeOf</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">setPrototypeOf</span>
    <span class="p">?</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">.</span><span class="nx">bind</span><span class="p">()</span>
    <span class="p">:</span> <span class="kd">function</span> <span class="nx">_getPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">__proto__</span> <span class="o">||</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
      <span class="p">};</span>
  <span class="k">return</span> <span class="nx">_getPrototypeOf</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_defineProperties</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">props</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">descriptor</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">descriptor</span><span class="p">.</span><span class="nx">enumerable</span> <span class="o">=</span> <span class="nx">descriptor</span><span class="p">.</span><span class="nx">enumerable</span> <span class="o">||</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">descriptor</span><span class="p">.</span><span class="nx">configurable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="dl">"</span><span class="s2">value</span><span class="dl">"</span> <span class="k">in</span> <span class="nx">descriptor</span><span class="p">)</span> <span class="nx">descriptor</span><span class="p">.</span><span class="nx">writable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">descriptor</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span> <span class="nx">descriptor</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_createClass</span><span class="p">(</span><span class="nx">Constructor</span><span class="p">,</span> <span class="nx">protoProps</span><span class="p">,</span> <span class="nx">staticProps</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">protoProps</span><span class="p">)</span> <span class="nx">_defineProperties</span><span class="p">(</span><span class="nx">Constructor</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">protoProps</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">staticProps</span><span class="p">)</span> <span class="nx">_defineProperties</span><span class="p">(</span><span class="nx">Constructor</span><span class="p">,</span> <span class="nx">staticProps</span><span class="p">);</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">Constructor</span><span class="p">,</span> <span class="dl">"</span><span class="s2">prototype</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">writable</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>
  <span class="k">return</span> <span class="nx">Constructor</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_classCallCheck</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">Constructor</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">instance</span> <span class="k">instanceof</span> <span class="nx">Constructor</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cannot call a class as a function</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_defineProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">value</span><span class="p">:</span> <span class="nx">value</span><span class="p">,</span>
      <span class="na">enumerable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">configurable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">writable</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">Parent</span> <span class="o">=</span> <span class="cm">/*#__PURE__*/</span> <span class="nx">_createClass</span><span class="p">(</span>
  <span class="kd">function</span> <span class="nx">Parent</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">Parent</span><span class="p">);</span>

    <span class="nx">_defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="dl">"</span><span class="s2">getName</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Parent:</span><span class="dl">"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
  <span class="p">}</span> <span class="c1">// 原型方法</span>
  <span class="c1">// 即 Person.prototype.getName = function() { }</span>
  <span class="c1">// 下面可以简写为 getName() {...}</span>
<span class="p">);</span>

<span class="kd">var</span> <span class="nx">Child</span> <span class="o">=</span> <span class="cm">/*#__PURE__*/</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">_Person</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">_inherits</span><span class="p">(</span><span class="nx">Child</span><span class="p">,</span> <span class="nx">_Person</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">_super</span> <span class="o">=</span> <span class="nx">_createSuper</span><span class="p">(</span><span class="nx">Child</span><span class="p">);</span>

  <span class="kd">function</span> <span class="nx">Child</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">age</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_this</span><span class="p">;</span>

    <span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">Child</span><span class="p">);</span>

    <span class="c1">// 子类中存在构造函数，则需要在使用“this”之前首先调用 super()。</span>
    <span class="nx">_this</span> <span class="o">=</span> <span class="nx">_super</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
    <span class="nx">_this</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">age</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">_this</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">_createClass</span><span class="p">(</span><span class="nx">Child</span><span class="p">);</span>
<span class="p">})(</span><span class="nx">Person</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Child</span><span class="p">(</span><span class="dl">"</span><span class="s2">yuxingxin</span><span class="dl">"</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span> <span class="c1">// 成功访问到父类的方法</span>
</pre></table></code></div></div><p>从上面编译完的源代码也可以看出，它采用的也是寄生组合式继承的方式。</p><h2 id="总结"><span class="mr-2">总结</span><a href="#总结" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>通过 Object.create 来划分不同的继承方式，最后的寄生式组合继承方式是通过组合继承改造之后的最优继承方式，而 extends 的语法糖和寄生组合继承的方式基本类似。</p><p><img data-src="https://tva1.sinaimg.cn/large/e6c9d24ely1h53un87lgpj21ce0i2juj.jpg" alt="" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/javascript/'>JavaScript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/%E7%BB%A7%E6%89%BF/" class="post-tag no-text-decoration" >继承</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="http://service.weibo.com/share/share.php?title=JavaScript%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%AE%9E%E7%8E%B0+-+%E5%AE%87%E8%A1%8C%E4%BF%A1&url=https%3A%2F%2Fyuxingxin.github.io%2Fposts%2Fjavascript-inherit%2F" data-toggle="tooltip" data-placement="top" title="Weibo" target="_blank" rel="noopener" aria-label="Weibo"> <i class="fa-fw fab fa-weibo"></i> </a> <a href="https://twitter.com/intent/tweet?text=JavaScript%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%AE%9E%E7%8E%B0+-+%E5%AE%87%E8%A1%8C%E4%BF%A1&url=https%3A%2F%2Fyuxingxin.github.io%2Fposts%2Fjavascript-inherit%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JavaScript%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%AE%9E%E7%8E%B0+-+%E5%AE%87%E8%A1%8C%E4%BF%A1&u=https%3A%2F%2Fyuxingxin.github.io%2Fposts%2Fjavascript-inherit%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fyuxingxin.github.io%2Fposts%2Fjavascript-inherit%2F&text=JavaScript%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%AE%9E%E7%8E%B0+-+%E5%AE%87%E8%A1%8C%E4%BF%A1" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/android-retrofit/">Android三方开源库之Retrofit源码分析</a><li><a href="/posts/android-binder/">Android Framework之Binder原理分析</a><li><a href="/posts/java-thread-communication/">Java多线程之线程通信</a><li><a href="/posts/java-jvm-memory/">JVM内存区域以及内存管理</a><li><a href="/posts/java-jvm-classloader/">JVM类加载机制及类加载器</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a> <a class="post-tag" href="/tags/framework/">framework</a> <a class="post-tag" href="/tags/jvm/">JVM</a> <a class="post-tag" href="/tags/array/">Array</a> <a class="post-tag" href="/tags/build/">build</a> <a class="post-tag" href="/tags/cache/">cache</a> <a class="post-tag" href="/tags/rxjava/">RxJava</a> <a class="post-tag" href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">数据类型</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/javascript-data-type/"><div class="card-body"> <em class="small" data-ts="1518652800" data-df="YYYY-MM-DD" > 2018-02-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JavaScript基础之数据类型及检测和转换</h3><div class="text-muted small"><p> 数据类型 JavaScript数据类型一共分为8种： Number（数值，包含NaN） String（字符串） Boolean（布尔值） Undefined（未定义/未初始化） Null（空对象） Symbol（独一无二的值，ES6 新增） BigInt （大整数，能够表示超过 Number 类型大小限制的整数，ES 2020新增） Object（对象。...</p></div></div></a></div><div class="card"> <a href="/posts/javascript-deep-clone/"><div class="card-body"> <em class="small" data-ts="1519603200" data-df="YYYY-MM-DD" > 2018-02-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JavaScript基础之对象深浅拷贝原理以及实现</h3><div class="text-muted small"><p> 我们知道JavaScript数据类型分为基本数据类型和引用数据类型，对于基本数据类型，变量存储的是基本类型的值，而对于引用数据类型， 变量存储的是其在内存中的地址，而通常拷贝一个对象，又分为浅拷贝和深拷贝两种，下面我们分别来讨论这种拷贝的区别。 浅拷贝 复制一个对象，如果对象属性是基本数据类型，复制的就是基本类型的值给新对象，但如果是引用数据类型，复制的就是内存中的地址，如果其中一个对象...</p></div></div></a></div><div class="card"> <a href="/posts/javascript-prototype/"><div class="card-body"> <em class="small" data-ts="1519948800" data-df="YYYY-MM-DD" > 2018-03-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JavaScript基础之原型与原型链的理解</h3><div class="text-muted small"><p> 理解原型与原型链对于我们实现继承、new关键字原理、甚至代码优化等非常重要，接下来我们对这块做一个总结。 概念 我们都知道，访问一个对象实例上的属性和方法时，首先在实例本身查找。 如果没有找到，会到实例对象的隐式属性__proto__上查找，就是该实例的构造函数的原型对象。如果还没有，会继续访问原型对象的原型,直到Object.prototype.__proto__(null)为止。这也...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/javascript-prototype/" class="btn btn-outline-primary" prompt="上一篇"><p>JavaScript基础之原型与原型链的理解</p></a> <a href="/posts/javascript-keywords/" class="btn btn-outline-primary" prompt="下一篇"><p>JavaScript基础之new、apply、call、bind实现原理</p></a></div><script src="https://utteranc.es/client.js" repo="yuxingxin/yuxingxin.github.io" issue-term="pathname" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://weibo.com/lx8909">yuxingxin</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">源码分析</a> <a class="post-tag" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a> <a class="post-tag" href="/tags/framework/">framework</a> <a class="post-tag" href="/tags/jvm/">JVM</a> <a class="post-tag" href="/tags/array/">Array</a> <a class="post-tag" href="/tags/build/">build</a> <a class="post-tag" href="/tags/cache/">cache</a> <a class="post-tag" href="/tags/rxjava/">RxJava</a> <a class="post-tag" href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">数据类型</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">发现新版本的内容。</p><button type="button" class="btn btn-primary" aria-label="Update"> 更新 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-VW6EGL8NPE"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-VW6EGL8NPE'); }); </script>
